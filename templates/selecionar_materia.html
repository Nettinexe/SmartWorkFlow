{% extends 'base.html' %}

{% block title %}Avaliar - {{ aluno.nome_completo }}{% endblock %}

{% block content %}
<div class="mb-4">
    <a href="{% url 'turma_detail' aluno.turma.id %}" class="text-decoration-none text-muted">
        <i class="bi bi-arrow-left" style="font-size: 20px;">Voltar para a Turma</i>
    </a>
    <h2 class="text-primary fw-bold mt-2">Avaliar: {{ aluno.nome_completo }}</h2>

    <a href="{% url 'visualizar_relatorio' relatorio.id %}" class="btn btn-dark shadow-sm">
        <i class="bi bi-file-earmark-pdf-fill"></i> Visualizar Relatório Final
    </a>
    
    <p class="text-muted">Relatório do 1º Trimestre de 2025 (Status: <span class="badge bg-warning text-dark">{{ relatorio.get_status_display }}</span>)</p>
</div>

<div class="row">
    <div class="col-12 mb-3">
        <h5 class="fw-bold"><i class="bi bi-grid-fill"></i> Selecione a Disciplina para Avaliar:</h5>
    </div>

    {% for item in materias %}
    <div class="col-md-3 mb-4">
        <a href="{% url 'avaliar_materia' relatorio.id item.codigo %}" class="text-decoration-none">
            
            <div class="card h-100 shadow-sm hover-effect text-center py-4 
                        {% if item.concluido %}border-success bg-success bg-opacity-10{% else %}border-0 bg-light{% endif %}"
                 style="{% if item.concluido %}border-width: 3px !important;{% endif %}">
                
                <div class="card-body position-relative">
                    
                    {% if item.concluido %}
                    <div class="position-absolute top-0 end-0 mt-n3 me-n3">
                        <span class="badge rounded-circle bg-success p-2 shadow">
                            <i class="bi bi-check-lg fs-4"></i>
                        </span>
                    </div>
                    {% endif %}

                    <i class="bi {{ item.icone }} display-4 mb-3 
                              {% if item.concluido %}text-success{% else %}text-primary{% endif %}"></i>
                    
                    <h5 class="card-title text-dark fw-bold">{{ item.nome }}</h5>
                    
                    {% if item.concluido %}
                        <p class="small text-success fw-bold mb-0">
                            <i class="bi bi-check-circle-fill"></i> Concluído!
                        </p>
                    {% else %}
                        <p class="small text-muted mb-0">Clique para abrir competências</p>
                    {% endif %}
                </div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>

<style>
    .hover-effect:hover {
        transform: scale(1.03);
        background-color: #e9ecef !important;
        transition: 0.2s;
        border: 2px solid #0d6efd !important;
    }
</style>
{% endblock %}